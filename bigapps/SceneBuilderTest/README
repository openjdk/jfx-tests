More tests needed
Some fixes needed - see TODOs
